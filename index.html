<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hybrid Athlete - Valutazione Performance</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { margin: 0; padding: 0; }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useRef } = React;
        const Activity = ({ className }) => (
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
            <path d="M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2" />
          </svg>
        );
        const Target = ({ className }) => (
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
            <circle cx="12" cy="12" r="10" />
            <circle cx="12" cy="12" r="6" />
            <circle cx="12" cy="12" r="2" />
          </svg>
        );
        const Zap = ({ className }) => (
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
            <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z" />
          </svg>
        );
        const Heart = ({ className }) => (
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
            <path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z" />
          </svg>
        );
        const ExternalLink = ({ className }) => (
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
            <path d="M15 3h6v6" />
            <path d="M10 14 21 3" />
            <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6" />
          </svg>
        );
        const Share2 = ({ className }) => (
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
            <circle cx="18" cy="5" r="3" />
            <circle cx="6" cy="12" r="3" />
            <circle cx="18" cy="19" r="3" />
            <line x1="8.59" x2="15.42" y1="13.51" y2="17.49" />
            <line x1="15.41" x2="8.59" y1="6.51" y2="10.49" />
          </svg>
        );
        const Download = ({ className }) => (
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
            <polyline points="7 10 12 15 17 10" />
            <line x1="12" x2="12" y1="15" y2="3" />
          </svg>
        );

        const HybridAthleteAssessment = () => {
          const [weight, setWeight] = useState('');
          const [squat, setSquat] = useState('');
          const [run5k, setRun5k] = useState('');
          const [results, setResults] = useState(null);
          const canvasRef = useRef(null);

          // Standard basati sul livello AVANZATO delle nuove tabelle
          const standards = {
            '65-70': {
              name: '65-70kg',
              squatRatio: 2.3,
              run5k: 1290 // 21:30
            },
            '70-75': {
              name: '70-75kg',
              squatRatio: 2.2,
              run5k: 1305 // 21:45
            },
            '75-80': {
              name: '75-80kg',
              squatRatio: 2.1,
              run5k: 1335 // 22:15
            },
            '80-85': {
              name: '80-85kg',
              squatRatio: 2.0,
              run5k: 1380 // 23:00
            },
            '85-90': {
              name: '85-90kg',
              squatRatio: 1.9,
              run5k: 1410 // 23:30
            },
            '90-95': {
              name: '90-95kg',
              squatRatio: 1.8,
              run5k: 1440 // 24:00
            }
          };

          const getWeightCategory = (w) => {
            if (w >= 65 && w < 70) return '65-70';
            if (w >= 70 && w < 75) return '70-75';
            if (w >= 75 && w < 80) return '75-80';
            if (w >= 80 && w < 85) return '80-85';
            if (w >= 85 && w < 90) return '85-90';
            if (w >= 90 && w <= 95) return '90-95';
            return null;
          };

          const timeToSeconds = (timeStr) => {
            const parts = timeStr.split(':');
            if (parts.length === 2) {
              return parseInt(parts[0]) * 60 + parseInt(parts[1]);
            }
            return parseInt(timeStr);
          };

          const secondsToTime = (seconds) => {
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${mins}:${secs.toString().padStart(2, '0')}`;
          };

          const calculateScore = (value, standard, lowerIsBetter = false) => {
            if (lowerIsBetter) {
              return Math.round((standard / value) * 100);
            } else {
              return Math.round((value / standard) * 100);
            }
          };

          const getPerformanceLevel = (score) => {
            if (score >= 110)
              return {
                level: 'Elite',
                color: 'bg-purple-100 border-purple-500 text-purple-800',
                emoji: 'üèÜ',
                badge: 'bg-purple-500'
              };
            if (score >= 100)
              return {
                level: 'Ottimo',
                color: 'bg-green-100 border-green-500 text-green-800',
                emoji: 'üíé',
                badge: 'bg-green-500'
              };
            if (score >= 90)
              return {
                level: 'Buono',
                color: 'bg-blue-100 border-blue-500 text-blue-800',
                emoji: '‚ö°',
                badge: 'bg-blue-500'
              };
            if (score >= 80)
              return {
                level: 'Discreto',
                color: 'bg-yellow-100 border-yellow-500 text-yellow-800',
                emoji: 'üìä',
                badge: 'bg-yellow-500'
              };
            return {
              level: 'Da migliorare',
              color: 'bg-orange-100 border-orange-500 text-orange-800',
              emoji: 'üìà',
              badge: 'bg-orange-500'
            };
          };

          const getOverallPerformance = (avgScore) => {
            if (avgScore >= 110)
              return {
                text: 'ELITE HYBRID ATHLETE',
                color: 'text-purple-400',
                emoji: 'üèÜ',
                desc: "Superi tutti gli standard d'elite!"
              };
            if (avgScore >= 100)
              return {
                text: 'OTTIMO HYBRID ATHLETE',
                color: 'text-green-400',
                emoji: 'üíé',
                desc: 'Raggiungi o superi gli standard!'
              };
            if (avgScore >= 90)
              return {
                text: 'BUON HYBRID ATHLETE',
                color: 'text-blue-400',
                emoji: '‚ö°',
                desc: "Vicino agli standard d'eccellenza!"
              };
            if (avgScore >= 80)
              return {
                text: 'HYBRID ATHLETE IN CRESCITA',
                color: 'text-yellow-400',
                emoji: 'üìä',
                desc: 'Buona base, continua a migliorare!'
              };
            return {
              text: 'HYBRID ATHLETE IN SVILUPPO',
              color: 'text-orange-400',
              emoji: 'üìà',
              desc: 'Ottimo inizio, hai ampi margini!'
            };
          };

          const getRecommendedProgram = (tests) => {
            const squatTest = tests.find((t) => t.name === 'Squat' && t.completed);
            const run5kTest = tests.find((t) => t.name === '5k Run' && t.completed);

            if (!squatTest) return null;

            const squatScore = squatTest.score;
            const avgRunningScore = run5kTest && run5kTest.score ? run5kTest.score : 0;

            const isSquatHigh = squatScore >= 100;
            const isSquatLow = squatScore < 80;
            const isRunningHigh = avgRunningScore >= 100;
            const isRunningLow = avgRunningScore < 80 || !run5kTest;

            if (isSquatHigh && isRunningHigh) {
              return {
                name: 'PROGRAMMA D',
                title: "L'Hybrid Avanzato",
                emoji: 'üî•',
                color: 'from-purple-600 to-pink-600',
                profile: 'Lifter Avanzato + Runner Avanzato',
                description:
                  'Sei forte sia in sala pesi che nella corsa! Hai bisogno di periodizzazione complessa per continuare a progredire in entrambi i domini.',
                focus: [
                  'Periodizzazione avanzata con fasi alternate',
                  'Volume alto su entrambe le discipline',
                  "Gestione sofisticata dell'interferenza",
                  'Peak performance su obiettivi specifici'
                ],
                frequency: '3 Strength + 3-4 Running',
                duration: '12 settimane'
              };
            }

            if (isSquatHigh && isRunningLow) {
              return {
                name: 'PROGRAMMA A',
                title: 'Il Lifter che Corre',
                emoji: 'üí™',
                color: 'from-orange-600 to-red-600',
                profile: 'Lifter Avanzato + Runner Principiante',
                description:
                  'Sei forte in sala pesi! Ora √® il momento di costruire una base aerobica solida senza perdere i tuoi guadagni di forza.',
                focus: [
                  'Mantenere/ottimizzare forza e massa muscolare',
                  'Introduzione graduale alla corsa con focus tecnico',
                  "Minimizzare interferenza tra pesi e corsa",
                  'Volume running progressivo ma conservativo'
                ],
                frequency: '3 Strength + 3 Running',
                duration: '12 settimane'
              };
            }

            if (isRunningHigh && isSquatLow) {
              return {
                name: 'PROGRAMMA E',
                title: 'Il Runner che Solleva',
                emoji: 'üèÉ',
                color: 'from-blue-600 to-cyan-600',
                profile: 'Runner Avanzato + Lifter Principiante',
                description:
                  'Ottima base aerobica! Ora aggiungi forza per diventare un atleta pi√π completo e prevenire infortuni.',
                focus: [
                  'Mantenere capacit√† aerobiche',
                  'Costruire forza fondamentale sui big lifts',
                  'Apprendimento tecnico in sala pesi',
                  'Migliorare economia di corsa con la forza'
                ],
                frequency: '3 Strength + 3-4 Running',
                duration: '12 settimane'
              };
            }

            if (isSquatLow && isRunningLow) {
              return {
                name: 'PROGRAMMA C',
                title: 'Il Novizio Totale',
                emoji: 'üå±',
                color: 'from-yellow-600 to-amber-600',
                profile: 'Lifter Principiante + Runner Principiante',
                description:
                  'Stai iniziando il tuo viaggio hybrid! Focus su tecnica, consistenza e costruzione di fondamenta solide.',
                focus: [
                  'Apprendimento tecnico prioritario su tutto',
                  'Volume ridotto e focus sulla consistenza',
                  'Costruzione base di forza e resistenza',
                  'Prevenzione infortuni e movimento corretto'
                ],
                frequency: '3 Strength + 3 Running',
                duration: '12 settimane'
              };
            }

            return {
              name: 'PROGRAMMA B',
              title: "L'Equilibrato",
              emoji: '‚öñÔ∏è',
              color: 'from-green-600 to-emerald-600',
              profile: 'Lifter Intermedio + Runner Principiante/Intermedio',
              description:
                'Hai una buona base! Continua a svilupparti in modo bilanciato su entrambi i fronti.',
              focus: [
                'Sviluppo continuo della forza con volume moderato',
                'Progressione aerobica costante',
                'Educazione su entrambe le discipline',
                'Crescita bilanciata senza sacrifici'
              ],
              frequency: '3 Strength + 3 Running',
              duration: '12 settimane'
            };
          };

          const generateInstagramStory = async () => {
            if (!results) {
              alert('‚ùå Nessun risultato da condividere. Completa prima la valutazione.');
              return;
            }

            const canvas = canvasRef.current;
            if (!canvas) {
              alert('‚ùå Errore tecnico. Ricarica la pagina e riprova.');
              return;
            }

            try {
              const ctx = canvas.getContext('2d');
              const width = 1080;
              const height = 1920;

              canvas.width = width;
              canvas.height = height;

              const gradient = ctx.createLinearGradient(0, 0, 0, height);
              gradient.addColorStop(0, '#0f172a');
              gradient.addColorStop(0.5, '#1e293b');
              gradient.addColorStop(1, '#0f172a');
              ctx.fillStyle = gradient;
              ctx.fillRect(0, 0, width, height);

              ctx.fillStyle = '#ffffff';
              ctx.font = 'bold 80px Arial';
              ctx.textAlign = 'center';
              ctx.fillText('HYBRID ATHLETE', width / 2, 200);

              const status = getOverallPerformance(results.avgScore);
              ctx.font = '200px Arial';
              ctx.fillText(status.emoji, width / 2, 450);

              ctx.font = 'bold 60px Arial';
              ctx.fillStyle = '#fbbf24';
              ctx.fillText(status.text, width / 2, 600);

              ctx.font = 'bold 180px Arial';
              ctx.fillStyle = '#ffffff';
              ctx.fillText(results.avgScore.toString(), width / 2, 820);

              ctx.font = '40px Arial';
              ctx.fillStyle = '#94a3b8';
              ctx.fillText('Punteggio Medio', width / 2, 880);

              ctx.font = 'bold 50px Arial';
              ctx.fillStyle = '#60a5fa';
              ctx.fillText(`${results.completedTests}/${results.totalPossibleTests} Test Completati`, width / 2, 980);

              ctx.font = '40px Arial';
              ctx.fillStyle = '#cbd5e1';
              ctx.fillText(`Categoria: ${results.category}`, width / 2, 1060);

              if (results.recommendedProgram) {
                ctx.fillStyle = '#1e293b';
                ctx.fillRect(100, 1150, width - 200, 350);
                
                ctx.fillStyle = '#fbbf24';
                ctx.font = 'bold 45px Arial';
                ctx.fillText('PROGRAMMA CONSIGLIATO', width / 2, 1230);
                
                ctx.font = '100px Arial';
                ctx.fillText(results.recommendedProgram.emoji, width / 2, 1360);
                
                ctx.fillStyle = '#ffffff';
                ctx.font = 'bold 50px Arial';
                ctx.fillText(results.recommendedProgram.title, width / 2, 1450);
              }

              ctx.fillStyle = '#64748b';
              ctx.font = '35px Arial';
              ctx.fillText('nicholasrubini.it', width / 2, height - 100);

              canvas.toBlob((blob) => {
                if (!blob) {
                  alert("‚ùå Errore nella creazione dell'immagine. Riprova.");
                  return;
                }

                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = 'hybrid-athlete-results.png';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);

                alert('‚úÖ Immagine scaricata! Controlla la cartella Download.');
              }, 'image/png');
            } catch (error) {
              console.error('Error generating image:', error);
              alert('‚ùå Errore: ' + error.message + '. Prova a fare uno screenshot.');
            }
          };

          const calculateResults = () => {
            const w = parseFloat(weight);

            if (!weight) {
              alert('‚ùå Peso √® obbligatorio');
              return;
            }

            const category = getWeightCategory(w);

            if (!category) {
              alert('‚ùå Peso deve essere tra 65-95kg');
              return;
            }

            if (!squat) {
              alert('‚ùå Squat √® obbligatorio (test di forza)');
              return;
            }

            if (!run5k) {
              alert('‚ùå Compila il tempo sui 5k (test di resistenza obbligatorio)');
              return;
            }

            const std = standards[category];
            const squatStandard = w * std.squatRatio;

            const tests = [];
            let completedTests = 0;
            const totalPossibleTests = 2;

            const squatValue = parseFloat(squat);
            tests.push({
              name: 'Squat',
              value: squatValue,
              standard: squatStandard,
              displayStandard: squatStandard.toFixed(1),
              ratio: (squatValue / w).toFixed(2),
              standardRatio: std.squatRatio,
              unit: 'kg',
              score: calculateScore(squatValue, squatStandard, false),
              higher: true,
              icon: 'üí™',
              completed: true,
              required: true
            });
            completedTests++;

            const run5kSec = timeToSeconds(run5k);
            tests.push({
              name: '5k Run',
              value: run5kSec,
              standard: std.run5k,
              displayValue: run5k,
              displayStandard: secondsToTime(std.run5k),
              unit: '',
              score: calculateScore(run5kSec, std.run5k, true),
              higher: false,
              icon: 'üèÉ‚Äç‚ôÇÔ∏è',
              completed: true,
              required: true
            });
            completedTests++;

            const completedTestsWithScores = tests.filter((t) => t.completed && t.score !== undefined);
            const avgScore = Math.round(
              completedTestsWithScores.reduce((sum, test) => sum + test.score, 0) /
                completedTestsWithScores.length
            );

            setResults({
              category: std.name,
              tests,
              avgScore,
              completedTests,
              totalPossibleTests,
              isPartial: completedTests < totalPossibleTests,
              recommendedProgram: getRecommendedProgram(tests)
            });
          };

          return (
            <div className="min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 p-4 md:p-8">
              <div className="max-w-4xl mx-auto">
                <div className="text-center mb-6 md:mb-8">
                  <div className="flex items-center justify-center gap-2 md:gap-3 mb-3 md:mb-4">
                    <Zap className="w-8 h-8 md:w-10 md:h-10 text-yellow-400" />
                    <h1 className="text-3xl md:text-5xl font-bold text-white">Hybrid Athlete</h1>
                    <Activity className="w-8 h-8 md:w-10 md:h-10 text-blue-400" />
                  </div>
                  <p className="text-slate-300 text-base md:text-lg">Valutazione Performance Completa</p>
                  <p className="text-slate-400 text-xs md:text-sm mt-2">
                    Forte. Esplosivo. Veloce. Resistente. In salute.
                  </p>
                </div>

                <div className="bg-slate-800 rounded-2xl p-4 md:p-6 lg:p-8 shadow-2xl mb-6 md:mb-8 border border-slate-700">
                  <h2 className="text-xl md:text-2xl font-bold text-white mb-4 md:mb-6 flex items-center gap-2">
                    <Target className="w-5 h-5 md:w-6 md:h-6 text-yellow-400" />
                    I Tuoi Dati
                  </h2>
                  
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                      <label className="block text-slate-300 mb-2 font-medium">
                        Peso (kg) <span className="text-red-400">*</span>
                      </label>
                      <input
                        type="number"
                        step="0.1"
                        value={weight}
                        onChange={(e) => setWeight(e.target.value)}
                        className="w-full bg-slate-700 text-white px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-yellow-400"
                      />
                    </div>

                    <div>
                      <label className="block text-slate-300 mb-2 font-medium">
                        Squat (kg) <span className="text-red-400">*</span>
                      </label>
                      <input
                        type="number"
                        step="0.5"
                        value={squat}
                        onChange={(e) => setSquat(e.target.value)}
                        className="w-full bg-slate-700 text-white px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-yellow-400"
                      />
                    </div>

                    <div>
                      <label className="block text-slate-300 mb-2 font-medium">
                        5k Run (mm:ss) <span className="text-red-400 text-sm">- obbligatorio *</span>
                      </label>
                      <input
                        type="text"
                        value={run5k}
                        onChange={(e) => setRun5k(e.target.value)}
                        className="w-full bg-slate-700 text-white px-4 py-3 rounded-lg focus:outline-none focus:ring-2 focus:ring-yellow-400"
                      />
                    </div>
                  </div>

                  <div className="mt-4 p-3 bg-slate-700 bg-opacity-50 rounded-lg border border-slate-600">
                    <p className="text-slate-400 text-xs">
                      <span className="text-red-400">*</span> = Obbligatorio
                    </p>
                  </div>

                  <button
                    onClick={calculateResults}
                    className="w-full mt-6 md:mt-8 bg-gradient-to-r from-yellow-400 to-orange-500 text-slate-900 font-bold py-4 md:py-5 rounded-lg hover:from-yellow-500 hover:to-orange-600 transition-all transform hover:scale-105 shadow-lg text-base md:text-lg"
                  >
                    VALUTA PERFORMANCE
                  </button>
                </div>

                {results && (
                  <div className="space-y-6">
                    <div className="bg-gradient-to-r from-slate-800 to-slate-700 rounded-2xl p-6 md:p-8 shadow-2xl border border-slate-600">
                      <div className="text-center">
                        <div className="text-5xl md:text-6xl mb-3 md:mb-4">
                          {getOverallPerformance(results.avgScore).emoji}
                        </div>
                        <h3
                          className={`text-2xl md:text-3xl font-bold mb-2 ${getOverallPerformance(results.avgScore).color}`}
                        >
                          {getOverallPerformance(results.avgScore).text}
                        </h3>
                        <p className="text-slate-400 text-xs md:text-sm mb-3 md:mb-4">
                          {getOverallPerformance(results.avgScore).desc}
                        </p>
                        <p className="text-slate-300 text-base md:text-lg mb-3 md:mb-4">
                          Categoria: {results.category}
                        </p>
                        
                        {results.isPartial && (
                          <div className="bg-yellow-900 bg-opacity-30 border border-yellow-600 rounded-lg p-3 mb-4 mx-auto max-w-md">
                            <p className="text-yellow-400 text-xs md:text-sm font-medium">‚ö†Ô∏è Valutazione Parziale</p>
                            <p className="text-yellow-300 text-xs mt-1">
                              Completa tutti i test per una valutazione completa
                            </p>
                          </div>
                        )}
                        
                        <div className="flex items-center justify-center gap-4 md:gap-6">
                          <div>
                            <div className="text-4xl md:text-5xl font-bold text-white">{results.avgScore}</div>
                            <div className="text-slate-400 text-xs md:text-sm mt-1">Punteggio Medio</div>
                          </div>
                          <div className="text-slate-500 text-3xl md:text-4xl">‚Ä¢</div>
                          <div>
                            <div className="text-2xl md:text-3xl font-bold text-blue-400">
                              {results.completedTests}/{results.totalPossibleTests}
                            </div>
                            <div className="text-slate-400 text-xs md:text-sm mt-1">Test Completati</div>
                          </div>
                        </div>
                      </div>
                    </div>

                    {results.recommendedProgram && (
                      <div
                        className={`bg-gradient-to-r ${results.recommendedProgram.color} rounded-2xl p-6 md:p-8 shadow-2xl border-2 border-white border-opacity-20`}
                      >
                        <div className="text-center mb-4 md:mb-6">
                          <div className="text-4xl md:text-5xl mb-2 md:mb-3">
                            {results.recommendedProgram.emoji}
                          </div>
                          <h3 className="text-xl md:text-3xl font-bold text-white mb-1 md:mb-2">
                            {results.recommendedProgram.name}: {results.recommendedProgram.title}
                          </h3>
                          <p className="text-white text-opacity-90 text-xs md:text-sm font-medium mb-1">
                            {results.recommendedProgram.profile}
                          </p>
                        </div>

                        <div className="bg-black bg-opacity-20 rounded-xl p-4 md:p-6 mb-4">
                          <p className="text-white text-center leading-relaxed text-sm md:text-base">
                            {results.recommendedProgram.description}
                          </p>
                        </div>

                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4 md:mb-6">
                          <div className="bg-black bg-opacity-20 rounded-lg p-4">
                            <h4 className="text-white font-bold mb-3 flex items-center gap-2 text-sm md:text-base">
                              <Target className="w-4 h-4 md:w-5 md:h-5" />
                              Focus del Programma
                            </h4>
                            <ul className="space-y-2">
                              {results.recommendedProgram.focus.map((item, idx) => (
                                <li
                                  key={idx}
                                  className="text-white text-opacity-90 text-xs md:text-sm flex items-start gap-2"
                                >
                                  <span className="text-yellow-300 mt-0.5">‚Ä¢</span>
                                  <span>{item}</span>
                                </li>
                              ))}
                            </ul>
                          </div>

                          <div className="bg-black bg-opacity-20 rounded-lg p-4">
                            <h4 className="text-white font-bold mb-3 flex items-center gap-2 text-sm md:text-base">
                              <Activity className="w-4 h-4 md:w-5 md:h-5" />
                              Struttura
                            </h4>
                            <div className="space-y-3">
                              <div>
                                <p className="text-white text-opacity-70 text-xs mb-1">Frequenza</p>
                                <p className="text-white font-bold text-sm md:text-base">
                                  {results.recommendedProgram.frequency}
                                </p>
                              </div>
                              <div>
                                <p className="text-white text-opacity-70 text-xs mb-1">Durata</p>
                                <p className="text-white font-bold text-sm md:text-base">
                                  {results.recommendedProgram.duration}
                                </p>
                              </div>
                            </div>
                          </div>
                        </div>

                        <div className="text-center">
                          <p className="text-white text-opacity-80 text-xs md:text-sm mb-4">
                            üí° Questo programma √® stato selezionato in base ai tuoi punti di forza e aree di
                            miglioramento
                          </p>
                          <a
                            href="https://www.nicholasrubini.it/prodotto/scheda-hybrid-athlete/"
                            target="_blank"
                            rel="noopener noreferrer"
                            className="inline-flex items-center gap-2 bg-white text-slate-900 font-bold px-6 md:px-8 py-4 rounded-lg hover:bg-slate-100 transition-all transform hover:scale-105 shadow-xl text-sm md:text-base"
                          >
                            <Zap className="w-4 h-4 md:w-5 md:h-5" />
                            SCOPRI IL PROGRAMMA
                            <ExternalLink className="w-4 h-4 md:w-5 md:h-5" />
                          </a>
                        </div>
                      </div>
                    )}

                    <div className="grid grid-cols-1 md:grid-cols-2 gap-3 md:gap-4">
                      {results.tests.map((test, idx) => {
                        if (!test.completed) {
                          return (
                            <div
                              key={idx}
                              className="rounded-xl p-4 md:p-5 border-2 border-slate-600 bg-slate-700 bg-opacity-50"
                            >
                              <div className="flex items-start justify-between mb-2 md:mb-3">
                                <div className="flex items-center gap-2">
                                  <span className="text-xl md:text-2xl opacity-50">{test.icon}</span>
                                  <h4 className="font-bold text-base md:text-lg text-slate-400">{test.name}</h4>
                                </div>
                                <span className="px-2 md:px-3 py-1 rounded-full text-xs font-bold bg-slate-600 text-slate-400">
                                  {test.required ? '‚ö†Ô∏è RICHIESTO' : '‚≠ï OPZ'}
                                </span>
                              </div>
                              <div className="text-center py-3 md:py-4">
                                <p className="text-slate-500 text-xs md:text-sm">Non disponibile</p>
                                <p className="text-slate-600 text-xs mt-1">Compila per vedere la valutazione</p>
                              </div>
                            </div>
                          );
                        }

                        const perf = getPerformanceLevel(test.score);
                        return (
                          <div key={idx} className={`rounded-xl p-4 md:p-5 border-2 ${perf.color}`}>
                            <div className="flex items-start justify-between mb-2 md:mb-3">
                              <div className="flex items-center gap-2">
                                <span className="text-xl md:text-2xl">{test.icon}</span>
                                <h4 className="font-bold text-base md:text-lg">{test.name}</h4>
                              </div>
                              <div className="text-right">
                                <div
                                  className={`px-2 md:px-3 py-1 rounded-full text-xs font-bold ${perf.badge} text-white mb-1`}
                                >
                                  {perf.emoji} {perf.level}
                                </div>
                                <div className="text-xl md:text-2xl font-bold">{test.score}</div>
                              </div>
                            </div>
                            
                            <div className="space-y-2">
                              <div className="flex justify-between items-center">
                                <span className="text-xs md:text-sm font-medium">Il tuo valore:</span>
                                <span className="font-bold text-sm md:text-base">
                                  {test.displayValue || test.value} {test.unit}
                                </span>
                              </div>
                              <div className="flex justify-between items-center">
                                <span className="text-xs md:text-sm font-medium">Standard:</span>
                                <span className="font-bold text-sm md:text-base">
                                  {test.higher ? '>' : '<'} {test.displayStandard || test.standard} {test.unit}
                                </span>
                              </div>
                              {test.ratio && (
                                <div className="flex justify-between items-center pt-2 border-t border-current border-opacity-20">
                                  <span className="text-xs">Rapporto:</span>
                                  <span className="text-xs md:text-sm font-bold">
                                    {test.ratio}x vs {test.standardRatio}x
                                  </span>
                                </div>
                              )}
                              <div className="mt-2 md:mt-3 bg-white bg-opacity-20 rounded-full h-2 overflow-hidden">
                                <div
                                  className={`h-full ${perf.badge} transition-all duratazione-500`}
                                  style={{ width: `${Math.min(test.score, 150)}%` }}
                                />
                              </div>
                            </div>
                          </div>
                        );
                      })}
                    </div>

                    <div className="bg-gradient-to-r from-pink-600 to-purple-600 rounded-2xl p-4 md:p-6 shadow-2xl border-2 border-white border-opacity-20">
                      <div className="text-center">
                        <h3 className="text-xl md:text-2xl font-bold text-white mb-2 md:mb-3">
                          Condividi i tuoi risultati! üì∏
                        </h3>
                        <p className="text-white text-opacity-90 text-xs md:text-sm mb-4">
                          Scarica un'immagine ottimizzata per Instagram Story e mostra le tue performance ai tuoi amici
                        </p>
                        <button
                          onClick={generateInstagramStory}
                          className="inline-flex items-center gap-2 bg-white text-purple-600 font-bold px-6 md:px-8 py-4 rounded-lg hover:bg-purple-50 transition-all transform hover:scale-105 shadow-xl text-sm md:text-base"
                        >
                          <Share2 className="w-4 h-4 md:w-5 md:h-5" />
                          CONDIVIDI SU INSTAGRAM
                          <Download className="w-4 h-4 md:w-5 md:h-5" />
                        </button>
                        <p className="text-white text-opacity-70 text-xs mt-3">
                          L'immagine verr√† scaricata automaticamente sul tuo dispositivo
                        </p>
                      </div>
                    </div>
                  </div>
                )}

                <canvas ref={canvasRef} style={{ display: 'none' }} />

                <div className="mt-6 md:mt-8 text-center text-slate-500 text-xs md:text-sm space-y-4">
                  {results && (
                    <div className="bg-slate-800 rounded-xl p-4 md:p-6 border border-slate-700 mb-4">
                      <h4 className="text-slate-300 font-bold mb-3 text-sm md:text-base">Sistema di Punteggio</h4>
                      <div className="grid grid-cols-2 md:grid-cols-5 gap-2 md:gap-3 text-xs">
                        <div className="bg-purple-900 bg-opacity-30 rounded p-2">
                          <div className="font-bold text-purple-400 text-xs">üèÜ Elite</div>
                          <div className="text-slate-400">‚â•110</div>
                        </div>
                        <div className="bg-green-900 bg-opacity-30 rounded p-2">
                          <div className="font-bold text-green-400 text-xs">üíé Ottimo</div>
                          <div className="text-slate-400">100-109</div>
                        </div>
                        <div className="bg-blue-900 bg-opacity-30 rounded p-2">
                          <div className="font-bold text-blue-400 text-xs">‚ö° Buono</div>
                          <div className="text-slate-400">90-99</div>
                        </div>
                        <div className="bg-yellow-900 bg-opacity-30 rounded p-2">
                          <div className="font-bold text-yellow-400 text-xs">üìä Discreto</div>
                          <div className="text-slate-400">80-89</div>
                        </div>
                        <div className="bg-orange-900 bg-opacity-30 rounded p-2 col-span-2 md:col-span-1">
                          <div className="font-bold text-orange-400 text-xs">üìà Da migliorare</div>
                          <div className="text-slate-400">&lt;80</div>
                        </div>
                      </div>
                    </div>
                  )}
                  <p className="text-xs md:text-sm">
                    Standard basati su atleti ibridi d'elite ‚Ä¢ Vichinghi Hybrid Training
                  </p>
                </div>
              </div>
            </div>
          );
        };

        const container = document.getElementById('root');
        const root = ReactDOM.createRoot(container);
        root.render(<HybridAthleteAssessment />);
    </script>
</body>
</html>
